<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Work+Sans" rel="stylesheet">
    <link rel="stylesheet" href="/assets/main.css">
    <link rel="stylesheet" href="/stylesheets/ogden.css"> 
    <meta property="og:image" content="http://localhost:4000/img/FacebookBanner.jpg" />
    <meta content="Ogden Studios" property="og:site_name"> 
    
    <meta content="How do I get an A+ in Mozilla Observatory with WordPress?" property="og:title"> 
     
    
    <meta content="article" property="og:type"> 
     
    
    <meta content="Learn how to get an A+ grade through Mozilla Observatory using WordPress." property="og:description"> 
     
    
    <meta content="http://localhost:4000/2019/03/11/how-do-i-get-an-a-plus-mozilla-observatory-wordpress.html" property="og:url"> 
     
    
    <meta content="/img/logo-high-resolution.png" property="og:image">
    <meta content="/img/OgdenLogo.jpg" property="twitter:image"> 
    
    <!-- Google Suite Verification -->
    <meta name="google-site-verification" content="Ay267gjaK2dbcK9EuGzYKc0xKCC-cNH8tc4D-rc5D2U" /></head><body><header role="banner">
    <nav>
        <a href="/"><img class="brand" src="/img/ogden-transparent.png"></a>
        <ul>
               
            <li><a href="/blog/">Blog</a></li>
              
            <li><a href="/experience/">Experience</a></li>
                  
            <li><a href="/projects/">Projects</a></li>
              
            <li><a href="/skills/">Skills</a></li>
              
            <li><a href="/tidbits/">Tidbits</a></li>
             
        </ul>
    </nav>
</header><main class="page" aria-label="Content">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How do I get an A+ in Mozilla Observatory with WordPress?</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-03-11T00:00:00-06:00" itemprop="datePublished">Mar 11, 2019
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>I recently wrote a blog post about <a href="https://ogdenstudios.xyz/2019/03/03/how-do-i-get-an-a-plus-mozilla-observatory-jekyll-netlify.html">getting an A+ in the Mozilla Observatory with Jekyll and Netlify</a>.</p>

<p>I wrote that post as I completed a Jekyll site for a client. My next projects are going to be WordPress sites, so it makes sense to do the same for the WordPress platform. Here’s how you can get an A+ on the Mozilla Observatory with a WordPress website.</p>

<h2 id="step-1-create-a-new-wordpress-website">Step 1: Create a new WordPress website</h2>

<p>This blog post assumes some technical knowledge, and setting up a WordPress site requires more than a few commands. I won’t go through the entire setup process. But I personally love <a href="https://www.dreamhost.com/">Dreamhost</a>. Here’s how you can <a href="https://www.dreamhost.com/">install WordPress on a Dreamhost server</a>.</p>

<p>Setting up WordPress through Dreamhost will give us access to the WordPress administration panel and an SFTP user. We’ll need both sets of credentials to complete the process.</p>

<h2 id="step-2-check-the-baseline-wordpress-grade">Step 2: Check the baseline WordPress grade</h2>

<p>Once you have WordPress spun up, log in, set up your admin account, and don’t do anything. Let’s see how a fresh WordPress install fares on <a href="https://observatory.mozilla.org">Mozilla Observatory</a>.</p>

<p>With a fresh WordPress 5.1 install, our website scores an <strong>F</strong>.</p>

<h2 id="step-3-set-up-https">Step 3: Set up HTTPS</h2>

<p>You’ll need to have an SSL certification for your site. With Dreamhost, I use <a href="https://www.dreamhost.com/hosting/ssl-tls-certificates/">Let’s Encrypt</a> because I think SSL certificates should be free.</p>

<p>When you analyze your site through Mozilla Observatory, you’ll be presented with a series of recommendations for improving your score. The first recommendation is automatically redirecting from HTTP to HTTPS.</p>

<p>First, we’ll need to change this in the WordPress administration settings.</p>

<p>Go to <strong>Dashboard &gt; Settings &gt; General &gt; WordPress Address/Site Address</strong> - make sure it begins with <code class="highlighter-rouge">https://</code></p>

<p>Next, you’ll want to set up that redirect in the <code class="highlighter-rouge">.htaccess</code> file as well.</p>

<p><a href="https://help.dreamhost.com/hc/en-us/articles/115000675027-FTP-overview-and-credentials">SFTP into your server</a> and edit the <code class="highlighter-rouge">.htaccess</code> file in the root of your WordPress directory. To set up the HTTPS redirect, it should look like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># BEGIN WordPress
&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine On
    RewriteCond %{SERVER_PORT} !^443$
    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
&lt;/IfModule&gt;
# END WordPress
</code></pre></div></div>

<p>Now check your Mozilla Observatory score again and you’ll see you’ve gotten a 20/100 score and passed 6/11 tests now. Still an <strong>F</strong>, but we’re improving.</p>

<h2 id="step-4-set-your-headers-in-a-child-theme">Step 4: Set your headers in a child theme</h2>

<p>Mozilla will walk you through which headers to set, one at a time, and explain what each one does. I won’t be going over these in-depth in this post. I encourage you to walk through the process yourself.</p>

<p>In order to set these headers, we’ll want to use a <code class="highlighter-rouge">functions.php</code> file in a child theme. This will allow us to easily set the headers through the WordPress administration page.</p>

<p><a href="https://www.hostinger.com/tutorials/how-to-create-wordpress-child-theme">Create a child theme</a> and then add the following to the bottom of the <strong>child theme’s</strong> <code class="highlighter-rouge">functions.php</code> file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/** Custom security HTTP headers **/
function add_security_header($headers) {
	$headers['Content-Security-Policy'] = "base-uri 'self'; default-src 'self'; form-action 'self'; frame-ancestors 'none'; img-src 'self'; script-src 'self'; style-src 'self'";
	$headers['Referrer-Policy'] = 'no-referrer';
	$headers['Strict-Transport-Security'] = 'max-age=63072000; includeSubDomains';
	$headers['X-Content-Type-Options'] = 'nosniff';
	$headers['X-Frame-Options'] = 'DENY';
	return $headers;
}

add_filter('wp_headers', 'add_security_header');
</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>

<p>With these headers, a blank Jekyll site should score an A+ on Mozilla Observatory with a score of 115/100. It will also clear almost all the Content Security Policy checks they run.</p>

<p>I did my best to make these settings as restrictive as possible, but WordPress breaks under the strictest settings. Setting the <code class="highlighter-rouge">default-src</code>, <code class="highlighter-rouge">script-src</code>, and <code class="highlighter-rouge">style-src</code> to <code class="highlighter-rouge">'self'</code> will allow WordPress to function as expected.</p>

<p>Even with those changes, the CSP is pretty locked down. You may find you need to make adjustments to these headers to get certain tools and components to work on your site. This puts you in a good spot because it’s good practice to make the necessary changes intentionally instead of trying to fix broken security policies retroactively.</p>

<h2 id="next-steps">Next Steps</h2>

<p>Getting an A+ on Mozilla Observatory doesn’t guarantee your site is entirely secure, especially if you’re running WordPress. There is a wealth of information out there about locking down a WordPress site. A few things to consider:</p>

<ol>
  <li><a href="https://jetpack.com/support/getting-started-with-jetpack/">Set up JetPack</a></li>
  <li><a href="https://css-tricks.com/snippets/wordpress/remove-wp-generator-meta-tag/">Remove the WP generator meta tag</a>.</li>
  <li><a href="https://codex.wordpress.org/Configuring_Automatic_Background_Updates">Configure auto-updates for WordPress Core, themes, and plug-ins</a>.</li>
</ol>

<p>If you end up purchasing hosting with Dreamhost, please consider using my personal <a href="https://www.dreamhost.com/r.cgi?2263245">referral link</a>.</p>

  </div><a class="u-url" href="/2019/03/11/how-do-i-get-an-a-plus-mozilla-observatory-wordpress.html" hidden></a>
</article>

<div>
<p>Questions? Comments? Send them all along to <a href="mailto: tyler@ogdenstudios.xyz">tyler@ogdenstudios.xyz</a></p>

<p>Want to support the open source work I do? <a href="https://ko-fi.com/ogdenstudios">Buy me a coffee</a>.</p>
</div>

    </main>
  </body>
</html>
